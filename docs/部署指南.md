# VoicePC éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
2. [æœ¬åœ°å¼€å‘éƒ¨ç½²](#æœ¬åœ°å¼€å‘éƒ¨ç½²)
3. [ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²](#ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²)
4. [Dockeréƒ¨ç½²](#dockeréƒ¨ç½²)
5. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ–¥ï¸ ç¯å¢ƒè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

| é¡¹ç›® | æœ€ä½é…ç½® | æ¨èé…ç½® |
|-----|---------|---------|
| CPU | åŒæ ¸ 2.0GHz | å››æ ¸ 3.0GHz+ |
| å†…å­˜ | 4GB | 8GB+ |
| ç¡¬ç›˜ | 5GBå¯ç”¨ç©ºé—´ | 10GB+ SSD |
| ç½‘ç»œ | å®½å¸¦ç½‘ç»œ | ç¨³å®šé«˜é€Ÿç½‘ç»œ |

### è½¯ä»¶è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Windows 10/11ï¼ˆ64ä½ï¼‰
- **Node.js**: v18.x æˆ–æ›´é«˜
- **Python**: 3.10 æˆ–æ›´é«˜
- **Git**: æœ€æ–°ç‰ˆæœ¬

---

## ğŸš€ æœ¬åœ°å¼€å‘éƒ¨ç½²

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/xueyy-999/ai-voice-assistant.git
cd ai-voice-assistant
```

### 2. åç«¯éƒ¨ç½²

#### 2.1 å®‰è£…Pythonä¾èµ–

```bash
cd backend
pip install -r requirements.txt
```

**å¯èƒ½é‡åˆ°çš„é—®é¢˜**ï¼š

- **SSLè¯ä¹¦é”™è¯¯**: ä½¿ç”¨å›½å†…é•œåƒ
```bash
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt
```

- **ç¼–è¯‘é”™è¯¯**: æŸäº›åŒ…éœ€è¦C++ç¼–è¯‘å™¨
  - å®‰è£… [Visual Studio Build Tools](https://visualstudio.microsoft.com/downloads/)
  - æˆ–ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬

#### 2.2 é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶`.env.example`ä¸º`.env`ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘`.env`æ–‡ä»¶ï¼š

```env
# DeepSeek APIé…ç½®
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_API_BASE=https://api.deepseek.com

# é˜¿é‡Œäº‘è¯­éŸ³é…ç½®ï¼ˆå¯é€‰ï¼‰
ALI_APPKEY=your_ali_appkey_here
ALI_ACCESS_KEY_ID=your_access_key_id
ALI_ACCESS_KEY_SECRET=your_access_key_secret

# æœåŠ¡é…ç½®
HOST=0.0.0.0
PORT=8000
DEBUG=True

# æ•°æ®åº“é…ç½®
DATABASE_PATH=./data/voicepc.db
```

#### 2.3 å¯åŠ¨åç«¯

```bash
python run_backend.py
```

æˆåŠŸå¯åŠ¨åä¼šçœ‹åˆ°ï¼š

```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     Application startup complete.
```

### 3. å‰ç«¯éƒ¨ç½²

#### 3.1 å®‰è£…Node.jsä¾èµ–

```bash
cd frontend
npm install
```

**å¯èƒ½é‡åˆ°çš„é—®é¢˜**ï¼š

- **ç½‘ç»œè¶…æ—¶**: ä½¿ç”¨å›½å†…é•œåƒ
```bash
npm config set registry https://registry.npmmirror.com
npm install
```

- **æƒé™é”™è¯¯**: 
```bash
npm install --legacy-peer-deps
```

#### 3.2 é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

åˆ›å»º`frontend/.env`ï¼š

```env
VITE_API_BASE_URL=http://localhost:8000/api
VITE_WS_URL=ws://localhost:8000/api/chat/ws
```

#### 3.3 å¯åŠ¨å‰ç«¯

```bash
npm run dev
```

è®¿é—® http://localhost:5173

### 4. éªŒè¯éƒ¨ç½²

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®å‰ç«¯åœ°å€
2. ç‚¹å‡»éº¦å…‹é£æŒ‰é’®æµ‹è¯•è¯­éŸ³è¾“å…¥
3. æŸ¥çœ‹åç«¯æ—¥å¿—ç¡®è®¤è¯·æ±‚æ­£å¸¸

---

## ğŸ­ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### 1. åç«¯ç”Ÿäº§éƒ¨ç½²

#### 1.1 ä½¿ç”¨Gunicornï¼ˆæ¨èï¼‰

```bash
# å®‰è£…Gunicorn
pip install gunicorn

# å¯åŠ¨æœåŠ¡ï¼ˆ4ä¸ªå·¥ä½œè¿›ç¨‹ï¼‰
gunicorn backend.app.main:app \
  --workers 4 \
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8000 \
  --access-logfile logs/access.log \
  --error-logfile logs/error.log \
  --daemon
```

#### 1.2 é…ç½®Nginxåå‘ä»£ç†

åˆ›å»º`/etc/nginx/sites-available/voicepc`ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }

    # åç«¯API
    location /api {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }

    # WebSocket
    location /api/chat/ws {
        proxy_pass http://localhost:8000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "Upgrade";
        proxy_set_header Host $host;
    }
}
```

å¯ç”¨é…ç½®ï¼š

```bash
sudo ln -s /etc/nginx/sites-available/voicepc /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

#### 1.3 é…ç½®ç³»ç»ŸæœåŠ¡

åˆ›å»º`/etc/systemd/system/voicepc.service`ï¼š

```ini
[Unit]
Description=VoicePC Backend Service
After=network.target

[Service]
Type=notify
User=voicepc
WorkingDirectory=/path/to/ai-voice-assistant/backend
Environment="PATH=/usr/local/bin:/usr/bin:/bin"
ExecStart=/usr/local/bin/gunicorn app.main:app \
  --workers 4 \
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8000
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š

```bash
sudo systemctl daemon-reload
sudo systemctl start voicepc
sudo systemctl enable voicepc
sudo systemctl status voicepc
```

### 2. å‰ç«¯ç”Ÿäº§éƒ¨ç½²

#### 2.1 æ„å»ºå‰ç«¯

```bash
cd frontend
npm run build
```

ç”Ÿæˆçš„æ–‡ä»¶åœ¨`frontend/dist`ç›®å½•ã€‚

#### 2.2 éƒ¨ç½²åˆ°æœåŠ¡å™¨

```bash
# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp -r dist/* user@server:/var/www/voicepc/

# æˆ–ä½¿ç”¨rsync
rsync -avz dist/ user@server:/var/www/voicepc/
```

---

## ğŸ³ Dockeréƒ¨ç½²

### 1. åˆ›å»ºDockerfile

**åç«¯Dockerfile** (`backend/Dockerfile`)ï¼š

```dockerfile
FROM python:3.10-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£…Pythonä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨å‘½ä»¤
CMD ["python", "run_backend.py"]
```

**å‰ç«¯Dockerfile** (`frontend/Dockerfile`)ï¼š

```dockerfile
FROM node:18-alpine AS builder

WORKDIR /app

# å®‰è£…ä¾èµ–
COPY package*.json ./
RUN npm install

# æ„å»º
COPY . .
RUN npm run build

# ç”Ÿäº§ç¯å¢ƒ
FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### 2. åˆ›å»ºdocker-compose.yml

```yaml
version: '3.8'

services:
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      - DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
      - ALI_APPKEY=${ALI_APPKEY}
    volumes:
      - ./backend/data:/app/data
      - ./backend/logs:/app/logs
    restart: always

  frontend:
    build: ./frontend
    ports:
      - "80:80"
    depends_on:
      - backend
    restart: always
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢
docker-compose down
```

---

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–

### 1. åç«¯ä¼˜åŒ–

- **å·¥ä½œè¿›ç¨‹æ•°**: æ ¹æ®CPUæ ¸å¿ƒæ•°é…ç½®ï¼ˆé€šå¸¸ä¸ºæ ¸å¿ƒæ•°Ã—2ï¼‰
- **è¿æ¥æ± **: é…ç½®æ•°æ®åº“è¿æ¥æ± 
- **ç¼“å­˜**: ä½¿ç”¨Redisç¼“å­˜çƒ­æ•°æ®
- **æ—¥å¿—**: é…ç½®æ—¥å¿—è½®è½¬ï¼Œé¿å…æ—¥å¿—æ–‡ä»¶è¿‡å¤§

### 2. å‰ç«¯ä¼˜åŒ–

- **CDN**: ä½¿ç”¨CDNåŠ é€Ÿé™æ€èµ„æº
- **å‹ç¼©**: å¯ç”¨gzip/brotliå‹ç¼©
- **ç¼“å­˜**: é…ç½®æµè§ˆå™¨ç¼“å­˜ç­–ç•¥
- **æ‡’åŠ è½½**: ç»„ä»¶æŒ‰éœ€åŠ è½½

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **APIå¯†é’¥**: ä¸è¦å°†å¯†é’¥æäº¤åˆ°ä»£ç ä»“åº“
2. **HTTPS**: ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPS
3. **é˜²ç«å¢™**: åªå¼€æ”¾å¿…è¦çš„ç«¯å£
4. **é™æµ**: å®ç°APIè¯·æ±‚é¢‘ç‡é™åˆ¶
5. **æ—¥å¿—**: è®°å½•æ‰€æœ‰è®¿é—®æ—¥å¿—ï¼Œå®šæœŸå®¡è®¡

---

## ğŸ“Š ç›‘æ§ä¸æ—¥å¿—

### 1. æ—¥å¿—é…ç½®

åç«¯æ—¥å¿—è·¯å¾„ï¼š`backend/logs/`
- `app.log` - åº”ç”¨æ—¥å¿—
- `error.log` - é”™è¯¯æ—¥å¿—
- `access.log` - è®¿é—®æ—¥å¿—

### 2. ç›‘æ§æŒ‡æ ‡

å»ºè®®ç›‘æ§ä»¥ä¸‹æŒ‡æ ‡ï¼š
- CPUä½¿ç”¨ç‡
- å†…å­˜ä½¿ç”¨ç‡
- è¯·æ±‚å“åº”æ—¶é—´
- é”™è¯¯ç‡
- WebSocketè¿æ¥æ•°

å¯ä½¿ç”¨å·¥å…·ï¼š
- **Prometheus + Grafana** - æŒ‡æ ‡æ”¶é›†å’Œå¯è§†åŒ–
- **ELK Stack** - æ—¥å¿—åˆ†æ
- **Sentry** - é”™è¯¯è¿½è¸ª

---

## â“ å¸¸è§é—®é¢˜

### Q1: åç«¯å¯åŠ¨å¤±è´¥ï¼Œæç¤ºæ¨¡å—æ‰¾ä¸åˆ°

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# ç¡®ä¿åœ¨backendç›®å½•ä¸‹
cd backend
# ä½¿ç”¨run_backend.pyå¯åŠ¨
python run_backend.py
```

### Q2: å‰ç«¯è¿æ¥ä¸ä¸Šåç«¯

**æ£€æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤åç«¯å·²å¯åŠ¨ï¼ˆè®¿é—® http://localhost:8000/docsï¼‰
2. æ£€æŸ¥å‰ç«¯ç¯å¢ƒå˜é‡é…ç½®
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ç½‘ç»œè¯·æ±‚

### Q3: WebSocketè¿æ¥å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
2. ç¡®è®¤Nginxé…ç½®æ­£ç¡®
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### Q4: è¯­éŸ³è¯†åˆ«ä¸å·¥ä½œ

**æ£€æŸ¥æ­¥éª¤**ï¼š
1. ç¡®è®¤æµè§ˆå™¨å·²æˆæƒéº¦å…‹é£æƒé™
2. æ£€æŸ¥APIå¯†é’¥é…ç½®
3. æŸ¥çœ‹åç«¯æ—¥å¿—é”™è¯¯ä¿¡æ¯

### Q5: å†…å­˜å ç”¨è¿‡é«˜

**ä¼˜åŒ–å»ºè®®**ï¼š
1. å‡å°‘å·¥ä½œè¿›ç¨‹æ•°
2. å®ç°ä¼šè¯æ¸…ç†æœºåˆ¶
3. é…ç½®æ—¥å¿—è½®è½¬
4. ä½¿ç”¨ä¸“ä¸šçš„AIæœåŠ¡è€Œéæœ¬åœ°æ¨¡å‹

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£**: https://github.com/xueyy-999/ai-voice-assistant/tree/main/docs
- **Issues**: https://github.com/xueyy-999/ai-voice-assistant/issues
- **æ›´æ–°æ—¶é—´**: 2025å¹´10æœˆ22æ—¥

---

## ğŸ”„ æ›´æ–°æ—¥å¿—

- **2025-10-22**: åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
  - å®Œæˆæœ¬åœ°å¼€å‘éƒ¨ç½²æŒ‡å—
  - æ·»åŠ Dockeréƒ¨ç½²æ–¹æ¡ˆ
  - è¡¥å……ç”Ÿäº§ç¯å¢ƒé…ç½®è¯´æ˜
